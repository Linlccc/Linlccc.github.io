{{ define "main" }}
  <header>
    <h1>
    {{ .Title }}
    {{ if site.Params.ShowRssButtonInSectionTermList }}
      {{ $rss := default (.OutputFormats.Get "rss") (.Parent.OutputFormats.Get "rss") }}
      {{ with $rss }}
        <a href="{{ .RelPermalink }}" title="RSS" aria-label="RSS">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
            stroke-linecap="round" stroke-linejoin="round" height="23">
            <path d="M4 11a9 9 0 0 1 9 9" />
            <path d="M4 4a16 16 0 0 1 16 16" />
            <circle cx="5" cy="19" r="1" />
          </svg>
        </a>
      {{ end }}
    {{ end }}
    </h1>
    {{ with .Description }}
      <div class="post-description">{{ . }}</div>
    {{ end }}
  </header>
  <!-- 得到所有要展示的页面 -->
  {{ $pages := site.RegularPages }}
  {{ if not site.Params.ShowAllPagesInArchive }}
    {{ $pages = where $pages "Type" "in" site.Params.mainSections }}
  {{ end }}

  <!-- 按发布日期展示 -->
  {{ range $pages.GroupByPublishDate "2006" }}
    {{ if ne .Key "0001" }}
      <div class="archive-year">
        <h2 class="archive-year-header">
          {{ .Key }}<sup class="archive-count">&nbsp;&nbsp;{{ len .Pages }}</sup>
        </h2>
        {{ range .Pages.GroupByDate "January" }}
        <div class="archive-month">
          <h3 class="archive-month-header">{{- .Key }}<sup class="archive-count">&nbsp;&nbsp;{{ len .Pages }}</sup></h3>
          <div class="archive-posts">
            {{ range .Pages }}
              {{ if eq .Kind "page" }}
                <div class="archive-entry">
                  <h3 class="archive-entry-title">
                    {{ markdownify .Title }}
                    {{ if .Draft }}<sup><span class="entry-isdraft">&nbsp;&nbsp;[draft]</span></sup>{{ end }}
                  </h3>
                  <div class="archive-meta">
                    {{ partial "post_meta.html" . }}
                  </div>
                  <a class="entry-link" aria-label="post link to {{ plainify .Title }}" href="{{ .Permalink }}"></a>
                </div>
              {{ end }}
            {{ end }}
          </div>
        </div>
        {{ end }}
      </div>
    {{ end }}
  {{ end }}
{{ end }}
