<!-- 页头模板
  参数：
  . : 页面上下文
-->

<!-- 获取默认主题 -->
<!-- TODO:看这段主题初始化，是否能hugo处理，不用js执行 -->
{{ $defaultTheme := site.Params.defaultTheme | default "auto" }}
<script>
  // 得到主题颜色
  const defaultTheme = "{{ $defaultTheme }}";
  let theme = localStorage.getItem("pref-theme") ?? defaultTheme;
  if(theme == 'auto') theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
  if(theme == 'dark') document.documentElement.classList.add('dark');
  else document.documentElement.classList.remove('dark');
  // 设置系统主题颜色(iphone上下空白处颜色)
  document.querySelector("meta[name=theme-color]").setAttribute("content", getComputedStyle(document.documentElement).getPropertyValue('--background-100'));
  // 冒泡
</script>

<header id="header">
  {{ partial "body/header/nav.html" . }}
</header>
